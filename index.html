
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Crandy Cooks Recipe Collection</title>
  <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    // Airtable Configuration
    const AIRTABLE_TOKEN = 'patVXpDnXMklg3Iya.a3afa5e3b11a69d8fbb6ea8abc171c13e3b8fdd7e68bb3c9621bd64847aef11c';
    const BASE_ID = 'appJkIT5G9ZkVgqgA';
    const TABLE_NAME = 'Table 1';

    const Music = ({ size = 24 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M9 18V5l12-2v13"></path>
        <circle cx="6" cy="18" r="3"></circle>
        <circle cx="18" cy="16" r="3"></circle>
      </svg>
    );

    const ChevronDown = ({ size = 24 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <polyline points="6 9 12 15 18 9"></polyline>
      </svg>
    );

    const ChevronUp = ({ size = 24 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <polyline points="18 15 12 9 6 15"></polyline>
      </svg>
    );

    const Copy = ({ size = 24 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
        <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
      </svg>
    );

    const Check = ({ size = 24 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <polyline points="20 6 9 17 4 12"></polyline>
      </svg>
    );

    const Heart = ({ size = 24, filled = false }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill={filled ? "currentColor" : "none"} stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
      </svg>
    );

    // Lucide React icons as inline SVG components
    const Search = ({ size = 24, className = "" }) => (
      <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <circle cx="11" cy="11" r="8"></circle>
        <path d="m21 21-4.35-4.35"></path>
      </svg>
    );

    const Plus = ({ size = 24 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <line x1="12" y1="5" x2="12" y2="19"></line>
        <line x1="5" y1="12" x2="19" y2="12"></line>
      </svg>
    );

    const Edit2 = ({ size = 24 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path>
      </svg>
    );

    const Trash2 = ({ size = 24 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <polyline points="3 6 5 6 21 6"></polyline>
        <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
        <line x1="10" y1="11" x2="10" y2="17"></line>
        <line x1="14" y1="11" x2="14" y2="17"></line>
      </svg>
    );

    const X = ({ size = 24 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>
    );

    const Video = ({ size = 24, className = "" }) => (
      <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <polygon points="23 7 16 12 23 17 23 7"></polygon>
        <rect x="1" y="5" width="15" height="14" rx="2" ry="2"></rect>
      </svg>
    );

    // Simple storage implementation using localStorage
    window.storage = {
      get: async (key) => {
        const value = localStorage.getItem(key);
        return value ? { key, value } : null;
      },
      set: async (key, value) => {
        localStorage.setItem(key, value);
        return { key, value };
      },
      delete: async (key) => {
        localStorage.removeItem(key);
        return { key, deleted: true };
      },
      list: async (prefix) => {
        const keys = [];
        for (let i = 0; i < localStorage.length; i++) {
          const key = localStorage.key(i);
          if (!prefix || key.startsWith(prefix)) {
            keys.push(key);
          }
        }
        return { keys };
      }
    };

    function RecipeCatalog() {
      const [recipes, setRecipes] = useState([]);
      const [searchTerm, setSearchTerm] = useState('');
      const [filterType, setFilterType] = useState('');
      const [filterServingSize, setFilterServingSize] = useState('');
      const [filterSeason, setFilterSeason] = useState('');
      const [isAdmin, setIsAdmin] = useState(false);
      const [showForm, setShowForm] = useState(false);
      const [editingRecipe, setEditingRecipe] = useState(null);
      const [saving, setSaving] = useState(false);
      const [selectedRecipe, setSelectedRecipe] = useState(null);
      const [showSpotify, setShowSpotify] = useState(false);
      const [copiedIngredients, setCopiedIngredients] = useState(false);
      const [successMessage, setSuccessMessage] = useState('');
      const [copiedRecipe, setCopiedRecipe] = useState(false);
      const [favorites, setFavorites] = useState([]);
      const [recentlyViewed, setRecentlyViewed] = useState([]);
      const [viewCounts, setViewCounts] = useState({});
      const [showDashboard, setShowDashboard] = useState(false);
      const [loading, setLoading] = useState(true);
      const [filterDietaryRestriction, setFilterDietaryRestriction] = useState('');
      const [formData, setFormData] = useState({
        title: '',
        description: '',
        ingredients: '',
        instructions: '',
        videoUrl: '',
        imageFile: null,
        imageFileData: null,
        tags: '',
        prepTime: '',
        cookTime: '',
        equipment: '',
        mealType: '',
        servingSize: '',
        season: '',
        dietaryRestrictions: ''
      });

      useEffect(() => {
        loadRecipes();
        loadFavorites();
        loadRecentlyViewed();
        loadViewCounts();
      }, []);

      const loadRecipes = async () => {
        setLoading(true);
        try {
          const response = await fetch(
            `https://api.airtable.com/v0/${BASE_ID}/${encodeURIComponent(TABLE_NAME)}`,
            {
              headers: {
                'Authorization': `Bearer ${AIRTABLE_TOKEN}`
              }
            }
          );
      
          if (!response.ok) {
            throw new Error('Failed to load recipes from Airtable');
          }
      
          const data = await response.json();
          const loadedRecipes = data.records.map(record => ({
            id: record.id,
            title: record.fields.title || '',
            description: record.fields.description || '',
            ingredients: record.fields.ingredients || '',
            instructions: record.fields.instructions || '',
            videoUrl: record.fields.videoUrl || '',
            imageFileData: record.fields.imageUrl?.[0]?.url || null,
            tags: record.fields.tags || '',
            prepTime: record.fields.prepTime || '',
            cookTime: record.fields.cookTime || '',
            equipment: record.fields.equipment || '',
            mealType: record.fields.mealType || '',
            servingSize: record.fields.servingSize || '',
            season: record.fields.season || '',
            dietaryRestrictions: record.fields.dietaryRestrictions || '',
            createdAt: new Date(record.createdTime).getTime()
          }));
          
          setRecipes(loadedRecipes.sort((a, b) => b.createdAt - a.createdAt));
        } catch (error) {
          console.error('Error loading recipes from Airtable:', error);
          alert('Error loading recipes. Please check your internet connection.');
        } finally {
          setLoading(false);
        }
      };
      
      const loadFavorites = async () => {
        try {
          const result = await window.storage.get('favorites');
          if (result) {
            setFavorites(JSON.parse(result.value));
          }
        } catch (error) {
          console.log('No favorites yet');
        }
      };

      const loadRecentlyViewed = async () => {
        try {
          const result = await window.storage.get('recentlyViewed');
          if (result) {
            setRecentlyViewed(JSON.parse(result.value));
          }
        } catch (error) {
          console.log('No recently viewed yet');
        }
      };

      const loadViewCounts = async () => {
        try {
          const result = await window.storage.get('viewCounts');
          if (result) {
            setViewCounts(JSON.parse(result.value));
          }
        } catch (error) {
          console.log('No view counts yet');
        }
      };
      
      const toggleFavorite = async (recipeId) => {
        let newFavorites;
        if (favorites.includes(recipeId)) {
          newFavorites = favorites.filter(id => id !== recipeId);
        } else {
          newFavorites = [...favorites, recipeId];
        }
        setFavorites(newFavorites);
        await window.storage.set('favorites', JSON.stringify(newFavorites));
      };

      const addToRecentlyViewed = async (recipeId) => {
        // Update recently viewed
        let newRecentlyViewed = recentlyViewed.filter(id => id !== recipeId);
        newRecentlyViewed.unshift(recipeId);
        newRecentlyViewed = newRecentlyViewed.slice(0, 3);
        setRecentlyViewed(newRecentlyViewed);
        await window.storage.set('recentlyViewed', JSON.stringify(newRecentlyViewed));
        
        // Update view counts
        const newViewCounts = {...viewCounts};
        newViewCounts[recipeId] = (newViewCounts[recipeId] || 0) + 1;
        setViewCounts(newViewCounts);
        await window.storage.set('viewCounts', JSON.stringify(newViewCounts));
      };
      
      const saveRecipe = async () => {
        setSaving(true);
        try {
          const fields = {
            title: formData.title,
            description: formData.description,
            ingredients: formData.ingredients,
            instructions: formData.instructions,
            videoUrl: formData.videoUrl,
            tags: formData.tags,
            prepTime: formData.prepTime,
            cookTime: formData.cookTime,
            equipment: formData.equipment,
            mealType: formData.mealType,
            servingSize: formData.servingSize,
            season: formData.season,
            dietaryRestrictions: formData.dietaryRestrictions
          };
      
          // Handle image if there's a new one
          //if (formData.imageFileData && formData.imageFile) {
          //  fields.imageUrl = [{
          //    url: formData.imageFileData
          //  }];
          //}
      
          let response;
          if (editingRecipe) {
            // Update existing recipe
            response = await fetch(
              `https://api.airtable.com/v0/${BASE_ID}/${encodeURIComponent(TABLE_NAME)}/${editingRecipe.id}`,
              {
                method: 'PATCH',
                headers: {
                  'Authorization': `Bearer ${AIRTABLE_TOKEN}`,
                  'Content-Type': 'application/json'
                },
                body: JSON.stringify({ fields })
              }
            );
          } else {
            // Create new recipe
            response = await fetch(
              `https://api.airtable.com/v0/${BASE_ID}/${encodeURIComponent(TABLE_NAME)}`,
              {
                method: 'POST',
                headers: {
                  'Authorization': `Bearer ${AIRTABLE_TOKEN}`,
                  'Content-Type': 'application/json'
                },
                body: JSON.stringify({ fields })
              }
            );
          }
      
          if (!response.ok) {
            throw new Error('Failed to save recipe to Airtable');
          }
      
          await loadRecipes();
          setSuccessMessage(editingRecipe ? 'Recipe updated successfully!' : 'Recipe added successfully!');
          setTimeout(() => setSuccessMessage(''), 3000);
          resetForm();
        } catch (error) {
          console.error('Save error:', error);
          alert('Error saving recipe to Airtable. Please try again.');
        } finally {
          setSaving(false);
        }
      };

      const deleteRecipe = async (id) => {
        if (!confirm('Are you sure you want to delete this recipe?')) {
          return;
        }
      
        try {
          const response = await fetch(
            `https://api.airtable.com/v0/${BASE_ID}/${encodeURIComponent(TABLE_NAME)}/${id}`,
            {
              method: 'DELETE',
              headers: {
                'Authorization': `Bearer ${AIRTABLE_TOKEN}`
              }
            }
          );
      
          if (!response.ok) {
            throw new Error('Failed to delete recipe from Airtable');
          }
      
          await loadRecipes();
          setSuccessMessage('Recipe deleted successfully!');
          setTimeout(() => setSuccessMessage(''), 3000);
        } catch (error) {
          console.error('Delete error:', error);
          alert('Error deleting recipe. Please try again.');
        }
      };

      const resetForm = () => {
        setFormData({
          title: '',
          description: '',
          ingredients: '',
          instructions: '',
          videoUrl: '',
          imageFile: null,
          imageFileData: null,
          tags: '',
          prepTime: '',
          cookTime: '',
          equipment: '',
          mealType: '',
          servingSize: '',
          season: '',
          dietaryRestrictions: ''
        });
        setEditingRecipe(null);
        setShowForm(false);
      };

      const startEdit = (recipe) => {
        setFormData({
          ...recipe,
          imageFile: null
        });
        setEditingRecipe(recipe);
        setShowForm(true);
      };

      const handleImageFile = async (e) => {
        const file = e.target.files?.[0];
        if (file) {
          const maxSize = 2 * 1024 * 1024;
          if (file.size > maxSize) {
            alert('Image file is too large (max 2MB). Please use a smaller or compressed image.');
            e.target.value = '';
            return;
          }

          const reader = new FileReader();
          reader.onload = (event) => {
            setFormData({
              ...formData,
              imageFile: file.name,
              imageFileData: event.target.result
            });
          };
          reader.readAsDataURL(file);
        }
      };

      const copyToClipboard = async (text, type) => {
        try {
          await navigator.clipboard.writeText(text);
          if (type === 'ingredients') {
            setCopiedIngredients(true);
            setTimeout(() => setCopiedIngredients(false), 2000);
          } else {
            setCopiedRecipe(true);
            setTimeout(() => setCopiedRecipe(false), 2000);
          }
        } catch (err) {
          alert('Failed to copy. Please try again.');
        }
      };

      const copyIngredients = (recipe) => {
        const text = `${recipe.title} - Ingredients:\n\n${recipe.ingredients}`;
        copyToClipboard(text, 'ingredients');
      };

      const copyFullRecipe = (recipe) => {
        let text = `${recipe.title}\n\n`;
        
        if (recipe.description) {
          text += `${recipe.description}\n\n`;
        }
        
        if (recipe.prepTime || recipe.cookTime || recipe.equipment) {
          text += `---\n`;
          if (recipe.prepTime) text += `Prep Time: ${recipe.prepTime}\n`;
          if (recipe.cookTime) text += `Cook Time: ${recipe.cookTime}\n`;
          if (recipe.equipment) text += `Equipment: ${recipe.equipment}\n`;
          text += `\n`;
        }
        
        if (recipe.ingredients) {
          text += `INGREDIENTS:\n${recipe.ingredients}\n\n`;
        }
        
        if (recipe.instructions) {
          text += `INSTRUCTIONS:\n`;
          const steps = recipe.instructions.split('\n').filter(i => i.trim());
          steps.forEach((step, idx) => {
            text += `${idx + 1}. ${step}\n`;
          });
        }
        
        if (recipe.videoUrl) {
          text += `\nVideo: ${recipe.videoUrl}`;
        }
        
        copyToClipboard(text, 'recipe');
      };

      const filteredRecipes = recipes.filter(recipe => {
        const searchLower = searchTerm.toLowerCase();
        const matchesSearch = (
          (recipe.title && recipe.title.toLowerCase().includes(searchLower)) ||
          (recipe.description && recipe.description.toLowerCase().includes(searchLower)) ||
          (recipe.ingredients && recipe.ingredients.toLowerCase().includes(searchLower)) ||
          (recipe.tags && recipe.tags.toLowerCase().includes(searchLower)) ||
          (recipe.equipment && recipe.equipment.toLowerCase().includes(searchLower))
        );
      
        const matchesType = !filterType || (recipe.mealType && recipe.mealType.includes(filterType));
        const matchesServingSize = !filterServingSize || recipe.servingSize === filterServingSize;
        const matchesSeason = !filterSeason || (recipe.season && recipe.season.includes(filterSeason));
        const matchesDietary = !filterDietaryRestriction || (recipe.dietaryRestrictions && recipe.dietaryRestrictions.includes(filterDietaryRestriction));

        return matchesSearch && matchesType && matchesServingSize && matchesSeason && matchesDietary;
        return matchesSearch && matchesType && matchesServingSize && matchesSeason;
      });

      return (
        <div className="min-h-screen bg-gradient-to-br from-green-50 to-stone-50">
          <header className="bg-white shadow-sm">
            <div className="max-w-7xl mx-auto px-4 py-6">
              <div className="flex justify-between items-center">
                <h1 className="text-3xl font-bold" style={{color: '#1c3652', fontFamily: "'Brush Script MT', cursive"}}>Crandy Cooks <span className="text-2xl font-normal" style={{fontFamily: "system-ui"}}>Recipe Collection</span></h1>
                <button
                  onClick={() => setIsAdmin(!isAdmin)}
                  className="px-4 py-2 text-white rounded-lg hover:opacity-90 transition" style={{backgroundColor: '#1c3652'}}
                >
                  {isAdmin ? 'View Mode' : 'Admin Mode'}
                </button>
              </div>
            </div>
          </header>
          
          {successMessage && (
            <div className="fixed top-20 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50">
              âœ“ {successMessage}
            </div>
          )}

          <div className="max-w-7xl mx-auto px-4 py-8">
            <div className="mb-8">
              <div className="relative">
                <Search className="absolute left-3 top-3 text-gray-400" size={20} />
                <input
                  type="text"
                  placeholder="Search recipes by name, ingredient, or tag..."
                  value={searchTerm}
                  onChange={(e) => setSearchTerm(e.target.value)}
                  className="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
                />
              </div>
            </div>
            <div className="mb-8">
            </div>
            
            {/* Recipe Count */}
            <div className="mb-4 text-sm text-gray-600">
              Showing {filteredRecipes.length} of {recipes.length} recipes
            </div>
            {/* Filters */}
            <div className="mb-6 bg-white p-4 rounded-lg shadow-sm border" style={{borderColor: '#1c3652'}}>
              <h3 className="text-sm font-semibold mb-3" style={{color: '#1c3652'}}>Filter Recipes</h3>
              <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">Type</label>
                  <select
                    value={filterType}
                    onChange={(e) => setFilterType(e.target.value)}
                    className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 text-sm"
                  >
                    <option value="">All Types</option>
                    <option value="breakfast">Breakfast</option>
                    <option value="lunch">Lunch</option>
                    <option value="dinner">Dinner</option>
                    <option value="dessert">Dessert</option>
                  </select>
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">Serving Size</label>
                  <select
                    value={filterServingSize}
                    onChange={(e) => setFilterServingSize(e.target.value)}
                    className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 text-sm"
                  >
                    <option value="">All Sizes</option>
                    <option value="dinner-for-two">Dinner for Two</option>
                    <option value="hosting-leftovers">Hosting / Leftovers</option>
                  </select>
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">Season</label>
                  <select
                    value={filterSeason}
                    onChange={(e) => setFilterSeason(e.target.value)}
                    className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 text-sm"
                  >
                    <option value="">All Seasons</option>
                    <option value="spring">Spring</option>
                    <option value="summer">Summer</option>
                    <option value="fall">Fall</option>
                    <option value="winter">Winter</option>
                  </select>
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">Dietary</label>
                  <select
                    value={filterDietaryRestriction}
                    onChange={(e) => setFilterDietaryRestriction(e.target.value)}
                    className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 text-sm"
                  >
                    <option value="">All</option>
                    <option value="dairy-free">Dairy Free</option>
                    <option value="dairy-free-option">Dairy Free Option</option>
                    <option value="vegetarian">Vegetarian</option>
                    <option value="vegetarian-option">Vegetarian Option</option>
                  </select>
                </div>
              </div>
            </div>

            {/* Recipe Dashboard - Collapsible */}
            {recipes.length > 0 && (
              <div className="mb-6">
                <button
                  onClick={() => setShowDashboard(!showDashboard)}
                  className="flex items-center justify-between w-full px-4 py-3 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition shadow-sm"
                  style={{borderColor: '#1c3652'}}
                >
                  <span className="font-medium" style={{color: '#1c3652'}}>ðŸ“Š Quick Access</span>
                  {showDashboard ? <ChevronUp size={20} /> : <ChevronDown size={20} />}
                </button>
                
                {showDashboard && (
                  <div className="mt-3 bg-white p-4 rounded-lg shadow-sm border" style={{borderColor: '#1c3652'}}>
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                      {/* Recently Viewed */}
                      {recentlyViewed.length > 0 && (
                        <div>
                          <p className="text-xs font-semibold mb-2" style={{color: '#1c3652'}}>Recently Viewed</p>
                          <div className="flex gap-2">
                            {recentlyViewed.slice(0, 3).map(recipeId => {
                              const recipe = recipes.find(r => r.id === recipeId);
                              if (!recipe) return null;
                              return (
                                <div
                                  key={recipe.id}
                                  onClick={() => {
                                    setSelectedRecipe(recipe);
                                    addToRecentlyViewed(recipe.id);
                                  }}
                                  className="flex-1 cursor-pointer hover:opacity-80 transition"
                                >
                                  {recipe.imageFileData ? (
                                    <img
                                      src={recipe.imageFileData}
                                      alt={recipe.title}
                                      className="w-full h-20 object-cover rounded-md mb-1"
                                      style={{border: '1px solid #1c3652'}}
                                    />
                                  ) : (
                                    <div className="w-full h-20 bg-gray-100 rounded-md flex items-center justify-center mb-1" style={{border: '1px solid #1c3652'}}>
                                      <Video size={20} className="text-gray-400" />
                                    </div>
                                  )}
                                  <p className="text-xs font-medium text-gray-800 line-clamp-1">{recipe.title}</p>
                                </div>
                              );
                            })}
                          </div>
                        </div>
                      )}
                      
                      {/* Most Viewed */}
                      {Object.keys(viewCounts).length > 0 && (
                        <div>
                          <p className="text-xs font-semibold mb-2" style={{color: '#1c3652'}}>Most Viewed</p>
                          {(() => {
                            const mostViewedId = Object.keys(viewCounts).reduce((a, b) => 
                              viewCounts[a] > viewCounts[b] ? a : b
                            );
                            const recipe = recipes.find(r => r.id === mostViewedId);
                            if (!recipe) return null;
                            return (
                              <div
                                onClick={() => {
                                  setSelectedRecipe(recipe);
                                  addToRecentlyViewed(recipe.id);
                                }}
                                className="cursor-pointer hover:opacity-80 transition"
                              >
                                {recipe.imageFileData ? (
                                  <img
                                    src={recipe.imageFileData}
                                    alt={recipe.title}
                                    className="w-full h-32 object-cover rounded-md mb-1"
                                    style={{border: '1px solid #1c3652'}}
                                  />
                                ) : (
                                  <div className="w-full h-32 bg-gray-100 rounded-md flex items-center justify-center mb-1" style={{border: '1px solid #1c3652'}}>
                                    <Video size={28} className="text-gray-400" />
                                  </div>
                                )}
                                <p className="text-xs font-medium text-gray-800 line-clamp-1">{recipe.title}</p>
                                <p className="text-xs text-gray-500">{viewCounts[mostViewedId]} views</p>
                              </div>
                            );
                          })()}
                        </div>
                      )}
                      
                      {/* Surprise Me */}
                      <div>
                        <p className="text-xs font-semibold mb-2" style={{color: '#1c3652'}}>Feeling Adventurous?</p>
                        <button
                          onClick={() => {
                            const randomRecipe = recipes[Math.floor(Math.random() * recipes.length)];
                            setSelectedRecipe(randomRecipe);
                            addToRecentlyViewed(randomRecipe.id);
                          }}
                          className="w-full h-32 bg-gradient-to-br from-green-100 to-stone-100 rounded-md flex flex-col items-center justify-center hover:opacity-80 transition"
                          style={{border: '1px solid #1c3652'}}
                        >
                          <span className="text-3xl mb-1">ðŸŽ²</span>
                          <span className="text-sm font-semibold" style={{color: '#1c3652'}}>Surprise Me!</span>
                        </button>
                      </div>
                    </div>
                  </div>
                )}
              </div>
            )}
    

            {/* Collapsible Spotify Player */}
            <div className="mb-6">
              <button
                onClick={() => setShowSpotify(!showSpotify)}
                className="flex items-center justify-between w-full px-4 py-3 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition shadow-sm"
              >
                <div className="flex items-center gap-2">
                  <Music size={20} className="text-green-600" />
                  <span className="font-medium text-gray-800">ðŸŽµ Cooking Playlist</span>
                </div>
                {showSpotify ? <ChevronUp size={20} /> : <ChevronDown size={20} />}
              </button>
              
              {showSpotify && (
                <div className="mt-3 bg-white border border-gray-300 rounded-lg p-3 shadow-sm">
                  <iframe 
                    style={{borderRadius: '12px'}} 
                    src="https://open.spotify.com/embed/playlist/3JI1THOW9yCNYhk6ZWaHZD?utm_source=generator" 
                    width="100%" 
                    height="380" 
                    frameBorder="0" 
                    allowFullScreen="" 
                    allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
                  />
                </div>
              )}
            </div>

            {isAdmin && (
              <div className="mb-6">
                <button
                  onClick={() => setShowForm(true)}
                  className="flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition"
                >
                  <Plus size={20} />
                  Add New Recipe
                </button>
              </div>
            )}

            {showForm && (
              <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                <div className="bg-white rounded-lg p-6 max-w-2xl w-full my-8 max-h-[90vh] overflow-y-auto">
                  <div className="flex justify-between items-center mb-4">
                    <h2 className="text-2xl font-bold text-gray-800">
                      {editingRecipe ? 'Edit Recipe' : 'Add New Recipe'}
                    </h2>
                    <button onClick={resetForm} className="text-gray-500 hover:text-gray-700">
                      <X size={24} />
                    </button>
                  </div>

                  <div className="space-y-4">
                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">Recipe Title</label>
                      <input
                        type="text"
                        value={formData.title}
                        onChange={(e) => setFormData({...formData, title: e.target.value})}
                        className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
                        placeholder="e.g., Grandma's Chocolate Chip Cookies"
                      />
                    </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">Description</label>
                      <textarea
                        value={formData.description}
                        onChange={(e) => setFormData({...formData, description: e.target.value})}
                        className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
                        rows="2"
                        placeholder="Brief description of the dish"
                      />
                    </div>

                    <div className="grid grid-cols-2 gap-4">
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">Prep Time</label>
                        <input
                          type="text"
                          value={formData.prepTime}
                          onChange={(e) => setFormData({...formData, prepTime: e.target.value})}
                          className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
                          placeholder="e.g., 15 mins"
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">Cook Time</label>
                        <input
                          type="text"
                          value={formData.cookTime}
                          onChange={(e) => setFormData({...formData, cookTime: e.target.value})}
                          className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
                          placeholder="e.g., 30 mins"
                        />
                      </div>
                    </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">Ingredients (one per line)</label>
                      <textarea
                        value={formData.ingredients}
                        onChange={(e) => setFormData({...formData, ingredients: e.target.value})}
                        className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
                        rows="6"
                        placeholder="2 cups flour&#10;1 cup sugar&#10;3 eggs"
                      />
                    </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">Equipment Needed (comma separated)</label>
                      <input
                        type="text"
                        value={formData.equipment}
                        onChange={(e) => setFormData({...formData, equipment: e.target.value})}
                        className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
                        placeholder="Cast iron skillet, slow cooker, food processor"
                      />
                    </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">Instructions (one step per line)</label>
                      <textarea
                        value={formData.instructions}
                        onChange={(e) => setFormData({...formData, instructions: e.target.value})}
                        className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
                        rows="6"
                        placeholder="Preheat oven to 350Â°F&#10;Mix dry ingredients&#10;Add wet ingredients"
                      />
                    </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">Recipe Image (optional)</label>
                      <input
                        type="file"
                        accept="image/*"
                        onChange={handleImageFile}
                        className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
                      />
                      {formData.imageFile && (
                        <p className="text-sm text-green-600 mt-1">âœ“ {formData.imageFile}</p>
                      )}
                      <p className="text-xs text-gray-500 mt-1">Max 2MB - screenshot from your video works great!</p>
                    </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">Video URL (Instagram or YouTube)</label>
                      <input
                        type="text"
                        value={formData.videoUrl}
                        onChange={(e) => setFormData({...formData, videoUrl: e.target.value})}
                        className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
                        placeholder="https://www.instagram.com/p/..."
                      />
                    </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">Type (select all that apply)</label>
                      <div className="flex gap-4">
                        <label className="flex items-center">
                          <input
                            type="checkbox"
                            checked={formData.mealType?.includes('breakfast') || false}
                            onChange={(e) => {
                              const types = formData.mealType ? formData.mealType.split(',') : [];
                              if (e.target.checked) {
                                types.push('breakfast');
                              } else {
                                const index = types.indexOf('breakfast');
                                if (index > -1) types.splice(index, 1);
                              }
                              setFormData({...formData, mealType: types.join(',')});
                            }}
                            className="mr-2"
                          />
                          Breakfast
                        </label>
                        <label className="flex items-center">
                          <input
                            type="checkbox"
                            checked={formData.mealType?.includes('lunch') || false}
                            onChange={(e) => {
                              const types = formData.mealType ? formData.mealType.split(',') : [];
                              if (e.target.checked) {
                                types.push('lunch');
                              } else {
                                const index = types.indexOf('lunch');
                                if (index > -1) types.splice(index, 1);
                              }
                              setFormData({...formData, mealType: types.join(',')});
                            }}
                            className="mr-2"
                          />
                          Lunch
                        </label>
                        <label className="flex items-center">
                          <input
                            type="checkbox"
                            checked={formData.mealType?.includes('dinner') || false}
                            onChange={(e) => {
                              const types = formData.mealType ? formData.mealType.split(',') : [];
                              if (e.target.checked) {
                                types.push('dinner');
                              } else {
                                const index = types.indexOf('dinner');
                                if (index > -1) types.splice(index, 1);
                              }
                              setFormData({...formData, mealType: types.join(',')});
                            }}
                            className="mr-2"
                          />
                          Dinner
                        </label>
                        <label className="flex items-center">
                          <input
                            type="checkbox"
                            checked={formData.mealType?.includes('dessert') || false}
                            onChange={(e) => {
                              const types = formData.mealType ? formData.mealType.split(',') : [];
                              if (e.target.checked) {
                                types.push('dessert');
                              } else {
                                const index = types.indexOf('dessert');
                                if (index > -1) types.splice(index, 1);
                              }
                              setFormData({...formData, mealType: types.join(',')});
                            }}
                            className="mr-2"
                          />
                          Dessert
                          </label>
                      </div>
                    </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">Serving Size</label>
                      <select
                        value={formData.servingSize || ''}
                        onChange={(e) => setFormData({...formData, servingSize: e.target.value})}
                        className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
                      >
                        <option value="">Select serving size</option>
                        <option value="dinner-for-two">Dinner for Two</option>
                        <option value="hosting-leftovers">Hosting / Leftovers</option>
                      </select>
                    </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">Season (select all that apply)</label>
                      <div className="flex gap-4">
                        <label className="flex items-center">
                          <input
                            type="checkbox"
                            checked={formData.season?.includes('spring') || false}
                            onChange={(e) => {
                              const seasons = formData.season ? formData.season.split(',') : [];
                              if (e.target.checked) {
                                seasons.push('spring');
                              } else {
                                const index = seasons.indexOf('spring');
                                if (index > -1) seasons.splice(index, 1);
                              }
                              setFormData({...formData, season: seasons.join(',')});
                            }}
                            className="mr-2"
                          />
                          Spring
                        </label>
                        <label className="flex items-center">
                          <input
                            type="checkbox"
                            checked={formData.season?.includes('summer') || false}
                            onChange={(e) => {
                              const seasons = formData.season ? formData.season.split(',') : [];
                              if (e.target.checked) {
                                seasons.push('summer');
                              } else {
                                const index = seasons.indexOf('summer');
                                if (index > -1) seasons.splice(index, 1);
                              }
                              setFormData({...formData, season: seasons.join(',')});
                            }}
                            className="mr-2"
                          />
                          Summer
                        </label>
                        <label className="flex items-center">
                          <input
                            type="checkbox"
                            checked={formData.season?.includes('fall') || false}
                            onChange={(e) => {
                              const seasons = formData.season ? formData.season.split(',') : [];
                              if (e.target.checked) {
                                seasons.push('fall');
                              } else {
                                const index = seasons.indexOf('fall');
                                if (index > -1) seasons.splice(index, 1);
                              }
                              setFormData({...formData, season: seasons.join(',')});
                            }}
                            className="mr-2"
                          />
                          Fall
                        </label>
                        <label className="flex items-center">
                          <input
                            type="checkbox"
                            checked={formData.season?.includes('winter') || false}
                            onChange={(e) => {
                              const seasons = formData.season ? formData.season.split(',') : [];
                              if (e.target.checked) {
                                seasons.push('winter');
                              } else {
                                const index = seasons.indexOf('winter');
                                if (index > -1) seasons.splice(index, 1);
                              }
                              setFormData({...formData, season: seasons.join(',')});
                            }}
                            className="mr-2"
                          />
                          Winter
                        </label>
                      </div>
                    </div>
                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">Dietary Restrictions (select all that apply)</label>
                      <div className="grid grid-cols-2 gap-2">
                        <label className="flex items-center">
                          <input
                            type="checkbox"
                            checked={formData.dietaryRestrictions?.includes('dairy-free') || false}
                            onChange={(e) => {
                              const restrictions = formData.dietaryRestrictions ? formData.dietaryRestrictions.split(',') : [];
                              if (e.target.checked) {
                                restrictions.push('dairy-free');
                              } else {
                                const index = restrictions.indexOf('dairy-free');
                                if (index > -1) restrictions.splice(index, 1);
                              }
                              setFormData({...formData, dietaryRestrictions: restrictions.join(',')});
                            }}
                            className="mr-2"
                          />
                          Dairy Free
                        </label>
                        <label className="flex items-center">
                          <input
                            type="checkbox"
                            checked={formData.dietaryRestrictions?.includes('dairy-free-option') || false}
                            onChange={(e) => {
                              const restrictions = formData.dietaryRestrictions ? formData.dietaryRestrictions.split(',') : [];
                              if (e.target.checked) {
                                restrictions.push('dairy-free-option');
                              } else {
                                const index = restrictions.indexOf('dairy-free-option');
                                if (index > -1) restrictions.splice(index, 1);
                              }
                              setFormData({...formData, dietaryRestrictions: restrictions.join(',')});
                            }}
                            className="mr-2"
                          />
                          Dairy Free Option
                        </label>
                        <label className="flex items-center">
                          <input
                            type="checkbox"
                            checked={formData.dietaryRestrictions?.includes('vegetarian') || false}
                            onChange={(e) => {
                              const restrictions = formData.dietaryRestrictions ? formData.dietaryRestrictions.split(',') : [];
                              if (e.target.checked) {
                                restrictions.push('vegetarian');
                              } else {
                                const index = restrictions.indexOf('vegetarian');
                                if (index > -1) restrictions.splice(index, 1);
                              }
                              setFormData({...formData, dietaryRestrictions: restrictions.join(',')});
                            }}
                            className="mr-2"
                          />
                          Vegetarian
                        </label>
                        <label className="flex items-center">
                          <input
                            type="checkbox"
                            checked={formData.dietaryRestrictions?.includes('vegetarian-option') || false}
                            onChange={(e) => {
                              const restrictions = formData.dietaryRestrictions ? formData.dietaryRestrictions.split(',') : [];
                              if (e.target.checked) {
                                restrictions.push('vegetarian-option');
                              } else {
                                const index = restrictions.indexOf('vegetarian-option');
                                if (index > -1) restrictions.splice(index, 1);
                              }
                              setFormData({...formData, dietaryRestrictions: restrictions.join(',')});
                            }}
                            className="mr-2"
                          />
                          Vegetarian Option
                        </label>
                      </div>
                    </div>
                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-1">Tags (comma separated)</label>
                      <input
                        type="text"
                        value={formData.tags}
                        onChange={(e) => setFormData({...formData, tags: e.target.value})}
                        className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
                        placeholder="dessert, cookies, chocolate, baking"
                      />
                    </div>

                    <div className="flex gap-3 pt-4">
                      <button
                        onClick={saveRecipe}
                        disabled={saving}
                        className="flex-1 px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition disabled:bg-gray-400 disabled:cursor-not-allowed"
                      >
                        {saving ? 'Saving...' : (editingRecipe ? 'Update Recipe' : 'Save Recipe')}
                      </button>
                      <button
                        onClick={resetForm}
                        disabled={saving}
                        className="px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition disabled:bg-gray-200"
                      >
                        Cancel
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            )}

            {filteredRecipes.length === 0 ? (
              <div className="text-center py-12">
                {recipes.length === 0 ? (
                  <div>
                    <div className="text-6xl mb-4">ðŸ‘¨â€ðŸ³</div>
                    <p className="text-gray-700 text-xl font-semibold mb-2">No recipes yet!</p>
                    <p className="text-gray-500">Click "Admin Mode" to add your first recipe.</p>
                  </div>
                ) : (
                  <div>
                    <div className="text-6xl mb-4">ðŸ”</div>
                    <p className="text-gray-700 text-xl font-semibold mb-2">No recipes found</p>
                    <p className="text-gray-500">Try adjusting your filters or search terms.</p>
                  </div>
                )}
              </div>
            ) : (
              <div className="grid grid-cols-1 gap-4">
                {filteredRecipes.map((recipe) => (
                  <div key={recipe.id} className="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-xl transition-all duration-300 hover:-translate-y-1" style={{border: '2px solid #1c3652'}}>
                    <div className="flex">
                      <div 
                        className="w-48 h-48 flex-shrink-0 bg-gray-100 cursor-pointer relative group overflow-hidden"
                        onClick={() => {
                          setSelectedRecipe(recipe);
                          addToRecentlyViewed(recipe.id);
                        }}
                      >
                        {recipe.imageFileData ? (
                          <>
                            <img 
                              src={recipe.imageFileData} 
                              alt={recipe.title}
                              className="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"
                            />
                            <div className="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition flex items-center justify-center">
                              <span className="text-white text-sm font-medium opacity-0 group-hover:opacity-100 transition">
                                View Recipe
                              </span>
                            </div>
                          </>
                        ) : (
                          <div className="w-full h-full flex items-center justify-center text-gray-400">
                            <Video size={48} />
                          </div>
                        )}
                      </div>

                      <div className="flex-1 p-4 flex flex-col justify-between">
                        <div>
                          <div className="flex justify-between items-start mb-2">
                            <h3 
                              className="text-2xl font-bold text-gray-800 cursor-pointer transition flex-1"
                              style={{color: '#1c3652'}}
                              onClick={() => {
                                setSelectedRecipe(recipe);
                                addToRecentlyViewed(recipe.id);
                              }}
                            >
                              {recipe.title}
                            </h3>
                            <div className="flex gap-2 ml-2">
                              <button
                                onClick={(e) => {
                                  e.stopPropagation();
                                  toggleFavorite(recipe.id);
                                }}
                                className="transition-colors"
                                style={{color: favorites.includes(recipe.id) ? '#1c3652' : '#D1D5DB'}}
                              >
                                <Heart size={24} filled={favorites.includes(recipe.id)} />
                              </button>
                              {isAdmin && (
                                <>
                                  <button
                                    onClick={() => startEdit(recipe)}
                                    className="text-blue-500 hover:text-blue-700"
                                  >
                                    <Edit2 size={18} />
                                  </button>
                                  <button
                                    onClick={() => deleteRecipe(recipe.id)}
                                    className="text-red-500 hover:text-red-700"
                                  >
                                    <Trash2 size={18} />
                                  </button>
                                </>
                              )}
                            </div>
                          </div>

                          <div className="space-y-2">
                            <div className="flex flex-wrap gap-x-4 gap-y-1 text-sm text-gray-600">
                              {recipe.prepTime && (
                                <span className="flex items-center">â±ï¸ Prep: {recipe.prepTime}</span>
                              )}
                              {recipe.cookTime && (
                                <span className="flex items-center">ðŸ³ Cook: {recipe.cookTime}</span>
                              )}
                              {recipe.equipment && (
                                <span className="flex items-center">ðŸ”ª {recipe.equipment}</span>
                              )}
                            </div>
                            <div className="flex flex-wrap gap-2">
                              {recipe.mealType && recipe.mealType.split(',').map((type, idx) => (
                                <span key={idx} className="px-2 py-1 text-xs rounded-full text-white" style={{backgroundColor: '#1c3652'}}>
                                  {type.trim()}
                                </span>
                              ))}
                              {recipe.servingSize && (
                                <span className="px-2 py-1 text-xs rounded-full text-white" style={{backgroundColor: '#1c3652'}}>
                                  {recipe.servingSize === 'dinner-for-two' ? 'Dinner for Two' : 'Hosting/Leftovers'}
                                </span>
                              )}
                              {recipe.season && recipe.season.split(',').map((s, idx) => (
                                <span key={idx} className="px-2 py-1 text-xs rounded-full text-white" style={{backgroundColor: '#1c3652'}}>
                                  {s.trim()}
                                </span>
                              ))}
                            </div>
                          </div>
                        </div>

                        <button
                          onClick={() => {
                            setSelectedRecipe(recipe);
                            addToRecentlyViewed(recipe.id);
                          }}
                          className="mt-3 self-start px-4 py-2 text-white text-sm rounded-lg hover:opacity-90 transition" style={{backgroundColor: '#1c3652'}}
                        >
                          View Full Recipe
                        </button>
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            )}

            {selectedRecipe && (
              <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 overflow-y-auto">
                <div className="bg-white rounded-lg max-w-4xl w-full my-8 max-h-[90vh] overflow-y-auto">
                  <div className="sticky top-0 bg-white border-b border-gray-200 p-4 flex justify-between items-center">
                    <h2 className="text-3xl font-bold text-gray-800">{selectedRecipe.title}</h2>
                    <button 
                      onClick={() => setSelectedRecipe(null)} 
                      className="text-gray-500 hover:text-gray-700"
                    >
                      <X size={24} />
                    </button>
                  </div>

                  <div className="p-6">
                    {selectedRecipe.imageFileData && (
                      <div className="relative bg-gray-100 mb-6 rounded-lg overflow-hidden">
                        <img 
                          src={selectedRecipe.imageFileData} 
                          alt={selectedRecipe.title}
                          className="w-full max-h-96 object-contain"
                        />
                        {selectedRecipe.videoUrl && (
                          <div className="absolute bottom-4 right-4">
                            <a
                              href={selectedRecipe.videoUrl}
                              target="_blank"
                              rel="noopener noreferrer"
                              className="flex items-center gap-2 px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition shadow-lg"
                            >
                              <Video size={20} />
                              Watch Video
                            </a>
                          </div>
                        )}
                      </div>
                    )}

                    {!selectedRecipe.imageFileData && selectedRecipe.videoUrl && (
                      <div className="mb-6">
                        <a
                          href={selectedRecipe.videoUrl}
                          target="_blank"
                          rel="noopener noreferrer"
                          className="flex items-center justify-center gap-2 px-4 py-3 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition"
                        >
                          <Video size={20} />
                          Watch Video on Instagram
                        </a>
                      </div>
                    )}

                    {selectedRecipe.description && (
                      <p className="text-gray-600 mb-4">{selectedRecipe.description}</p>
                    )}

                    <div className="flex flex-wrap gap-4 text-gray-600 mb-6">
                      {selectedRecipe.prepTime && <span>â±ï¸ Prep: {selectedRecipe.prepTime}</span>}
                      {selectedRecipe.cookTime && <span>ðŸ³ Cook: {selectedRecipe.cookTime}</span>}
                      {selectedRecipe.equipment && <span>ðŸ”ª Equipment: {selectedRecipe.equipment}</span>}
                    </div>

                    {/* Copy Buttons */}
                    <div className="flex flex-wrap gap-3 mb-6">
                      <button
                        onClick={() => copyIngredients(selectedRecipe)}
                        className="flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition"
                      >
                        {copiedIngredients ? <Check size={18} /> : <Copy size={18} />}
                        {copiedIngredients ? 'âœ“ Copied!' : 'ðŸ“‹ Copy Ingredients'}
                      </button>
                      <button
                        onClick={() => copyFullRecipe(selectedRecipe)}
                        className="flex items-center gap-2 px-4 py-2 text-white rounded-lg hover:opacity-90 transition" style={{backgroundColor: '#1c3652'}}
                      >
                        {copiedRecipe ? <Check size={18} /> : <Copy size={18} />}
                        {copiedRecipe ? 'âœ“ Copied!' : 'ðŸ“„ Copy Full Recipe'}
                      </button>
                    </div>

                    {selectedRecipe.ingredients && (
                      <div className="mb-6">
                        <h4 className="text-xl font-bold text-gray-800 mb-3">Ingredients</h4>
                        <div className="text-gray-700 space-y-2">
                          {selectedRecipe.ingredients.split('\n').filter(i => i.trim()).map((ingredient, idx) => {
                            // Check if this line is a section header (wrapped in **)
                            const isHeader = ingredient.trim().startsWith('**') && ingredient.trim().endsWith('**');
                            
                            if (isHeader) {
                              // Remove the ** and display as a bold header
                              const headerText = ingredient.trim().slice(2, -2);
                              return (
                                <p key={idx} className="font-bold text-gray-800 mt-4 first:mt-0">
                                  {headerText}
                                </p>
                              );
                            } else {
                              // Display as a regular bullet point
                              return (
                                <div key={idx} className="flex items-start">
                                  <span style={{color: '#1c3652'}} className="mr-2">â€¢</span>
                                  <span>{ingredient}</span>
                                </div>
                              );
                            }
                          })}
                        </div>
                      </div>
                    )}
                    

                    {selectedRecipe.instructions && (
                      <div className="mb-6">
                        <h4 className="text-xl font-bold text-gray-800 mb-3">Instructions</h4>
                        <ol className="text-gray-700 space-y-3">
                          {selectedRecipe.instructions.split('\n').filter(i => i.trim()).map((step, idx) => (
                            <li key={idx} className="flex items-start">
                              <span className="font-bold text-orange-500 mr-3 flex-shrink-0">{idx + 1}.</span>
                              <span>{step}</span>
                            </li>
                          ))}
                        </ol>
                      </div>
                    )}

                    {selectedRecipe.tags && (
                      <div className="flex flex-wrap gap-2">
                        {selectedRecipe.tags.split(',').map((tag, idx) => (
                          <span
                            key={idx}
                            className="px-3 py-1 bg-orange-100 text-orange-700 text-sm rounded-full"
                          >
                            {tag.trim()}
                          </span>
                        ))}
                      </div>
                    )}
                  </div>
                </div>
              </div>
            )}
          </div>
        </div>
      );
    }

    ReactDOM.render(<RecipeCatalog />, document.getElementById('root'));
  </script>
</body>
</html>
